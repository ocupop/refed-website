{% assign filters = site.data.policy_tool['date_labeling'].filters %}
<section>
  <div class="container-fluid">
    <div id="labeling-carousel-intro" class="row">
      <div class="col-xs-12 col-lg-5">
        <div class="content">
          <h2>Date Labeling Policy Issues</h2>
          <p>The date labels on food packaging accompanied by phrases such as “use by,” “best before,” “sell by,” “enjoy by” and “expires on” are generally intended to communicate food quality, not food safety. Nevertheless, date labels exert a powerful influence on consumers and food vendors. Under federal law, date labels are almost entirely unregulated. States have filled the void with a wide variety of regulations that often fail to reflect the distinction between food safety and food quality.<p> 

          <p>This tool explores the date label regulation patterns across the country. The extreme variations demonstrate how our current system creates confusion for consumers while not necessarily improving food safety, ultimately resulting in significant waste of wholesome food.</p>

          <p>ReFED found that standardizing date labels nationally was the most cost-effective solution to this country’s food waste problem. The fairly simple solution has the potential to divert 398,000 tons of food waste per year and provide $1.8 billion in annual economic value.</p>
          <button id="start-slides" class="button" style="margin: 30px 0;">Explore the map &gt;</button>
        </div>
      </div>
      <div class="col-xs-12 col-lg-7">
        <img src="/img/maps/map_date-label-05.svg">
      </div>
    </div>
    <div class="row carousel-datelabel">
      <div class="col-xs-12 col-lg-5">
        <div class="content">
          <div id="carousel-date-label" class="carousel slide" data-ride="carousel" data-interval="false" data-wrap="false">
            <div class="carousel-inner" role="listbox">
              {% for item in filters %}
                <div class="item{% if forloop.first %} active{% endif %}"
                     data-states='{{ item.states | jsonify }}'
                     data-progress="{% cycle '20', '40', '60', '80' %}"
                     data-map="#map_{{ forloop.index }}">
                  <h3 class="item-title"><i class="icon {% cycle 'cream-darker','recovery-light','recovery','prevention' %}"></i>{{ item.title }}</h3>
                  <p>{{ item.definition }}</p>
                </div>
              {% endfor %}
              <div class="item explore" data-progress="100" data-map="#map_5">
                <h2>Explore Each State</h2>
                <ul class="nav">
                  <li>
                    <i class="icon cream-dark"></i>No date label regulations.
                  </li>
                  <li>
                    <i class="icon recovery-light"></i>Date labels required for certain foods.<br>No restrictions on sales after those dates.
                  </li>
                  <li>
                    <i class="icon recovery"></i>Date labels required for certain foods.<br>Regulations on sales after those dates.
                  </li>
                  <li>
                    <i class="icon prevention"></i>No date label regulations.<br>Regulations on sales after dates if date labels are voluntarily applied.
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="content text-center">
          <div class="carousel-controls">
            <a class="left" href="#carousel-date-label" role="button" data-slide="prev">
              <i class="icon-prev"></i>
              <span class="sr-only">Previous</span>
            </a>
            <div class="progress">
              <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 20%;">
                <span class="sr-only">20% Complete</span>
              </div>
            </div>
            <a class="right" href="#carousel-date-label" role="button" data-slide="next">
              <i class="icon-next"></i>
              <span class="sr-only">Next</span>
            </a>
          </div>
        </div>
      </div>
      <div class="col-xs-12 col-lg-7">
        <div class="content" style="padding-top: 60%;">
          {% for map in (1..5) %}
          <div id="map_{{ forloop.index }}" class="map-datelabel{% if forloop.first %} active{% endif %}">
            <img src="/img/maps/map_date-label-0{{ forloop.index }}.svg">
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</section>

<script>
// TODO refactor into seperate js
  $('#carousel-date-label').on('slid.bs.carousel', function (e) {
    var direction = e.direction;
    var progress = $(e.relatedTarget).data("progress");
    var current_map = $(e.relatedTarget).data("map");

    $('.map-datelabel').removeClass('active');
    $(current_map).addClass('active');

    $('.progress-bar').css("width", progress + "%").attr("aria-valuenow", progress);
    if(progress == 100) {
      $('.right').addClass('hide');
    }else{
      $('.right').removeClass('hide');
    }
  });

  $('#start-slides').click(function(){
    $('#labeling-carousel-intro').hide();
    $('.carousel-datelabel').fadeIn();
  });
   
</script>

