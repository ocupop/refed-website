---
layout: page
title: Downloads
permalink: /download
slug: downloads
---
<section>
  <div id="signup-signin" class="container">
    <div class="row">
      <div class="col-xs-12 col-sm-6">
        <div class="content">
          <h2>Please fill out the form to access downloads</h2>
          <p>As part of our continuing research efforts, weâ€™d love to know who the report is reaching. Please submit the form to access all ReFED report content.</p>
          <form id="signup_form" name="signup_form" accept-charset="UTF-8" autocomplete="off" enctype="multipart/form-data" method="post" novalidate action="https://ancient-wave-20081.herokuapp.com/signup">
            <div class="hide">
              <label for="comment">Comments</label>
              <textarea name="comment" id="comment" rows="1" cols="1"></textarea>
            </div>
            <div class="form-inputs">
              <label class="sr">First Name</label>
              <input type="text" id="first_name" name="first_name" placeholder="First Name *" required>
              <label class="sr">Last Name</label>
              <input type="text" id="last_name" name="last_name" placeholder="Last Name *" required>
              <label class="sr">Email</label>
              <input type="text" id="email" name="email" placeholder="Email *" required>
              <input type="submit" value="Submit" class="button">
            </div>
          </form>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6">
        <div class="well" style="margin-top: 78px;">
          <div class="content">
            <h2>Are you a returning user?</h2>
            <p>If you have already signed up for access to the downloads just enter your email address below to regain access.</p>
            <form id="signin_form" name="signin_form" accept-charset="UTF-8" autocomplete="off" enctype="multipart/form-data" method="post" novalidate action="https://ancient-wave-20081.herokuapp.com/signin">
              <div class="form-inputs">
                <label class="sr">Email</label>
                <input type="text" id="email_return" name="email_return" placeholder="Email *" required>
                <input type="submit" value="Submit" class="button">
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="profile" class="container" style="display:none;">
    <div class="row center-xs middle-xs">
      <div class="col-xs-12">
        <div class="content">
          <h2>Thank You!</h2>
          <p class="lead">You have access to all downloadable content below. Help us continue our research by answering the questions below. We will never share your information and will use it only to keep you updated on new information, resources, or ways to get involved.</p>
          <form autocomplete="off" method="post" action="https://ancient-wave-20081.herokuapp.com/update" novalidate>
            <div class="row">
              <div class="col-xs-12 col-sm-6">
                <div class="hide">
                  <label for="comment">Comments</label>
                  <textarea name="comment" id="comment" rows="1" cols="1"></textarea>
                </div>
                <div class="select">
                  <select id="confirm_stakeholder" name="confirm_stakeholder" multiple>
                    <option>Choose a Stakeholder Group</option>
                    {% for stakeholder in site.stakeholders %}
                    <option value="{{ stakeholder.title }}">{{ stakeholder.title }}</option>
                    {% endfor %}
                  </select>
                </div>
                <div class="select">
                  <select id="confirm_solutions" name="confirm_solutions" multiple>
                    <option>Choose interested solutions</option>
                    {% for solution in site.solutions %}
                    <option value="{{ solution.title }}">{{ solution.title }}</option>
                    {% endfor %}
                  </select>
                </div>
              </div>
              <div class="col-xs-12 col-sm-6">
                <div class="form-inputs">
                  <label class="sr">First Name</label>
                  <input type="text" id="confirm_first_name" name="confirm_first_name" placeholder="First Name *" required>
                  <label class="sr">Last Name</label>
                  <input type="text" id="confirm_last_name" name="confirm_last_name" placeholder="Last Name *" required>
                  <label class="sr">Email</label>
                  <input type="text" id="confirm_email" name="confirm_email" placeholder="Email *" required>
                  <label class="sr">Organization Name</label>
                  <input type="text" id="confirm_organization" name="confirm_organization" placeholder="Organization Name">
                  <label class="sr">Zipcode</label>
                  <input type="text" id="confirm_zip_code" name="confirm_zip_code" placeholder="Zip" class="zip">
                  <input type="submit" value="Update" class="button">
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>
{% assign chapters = site.data.report %}
{% for chapter in chapters %}
  <section id="{{ chapter.title | slugify }}" class="chapter {% cycle 'alternate', '' %}">
    <div class="container">
      <div class="row">
        <div class="col-xs-12 col-sm-4">
          <div class="content text-right">
            <img src="{% asset_path 'downloads/{{ chapter.thumbnail }}' %}" class="img-responsive">
          </div>
        </div>
        <div class="col-xs-12 col-sm-8">
          <div class="content">
            <h2>{{ chapter.title }}</h2>
            <p><em>{{ chapter.summary }}</em></p>
            <a href="{{ site.baseurl }}/downloads/{{ chapter.download }}" class="button disabled" onClick="ga('send', 'event', 'button', 'pdf download', '{{ chapter.title }}');" target="_blank"><i class="icon icon-download"></i>Download {{ chapter.title }}</a><br>
            <p class="message">To enable downloads, please fill out the above <a href="#signup-form">form</a></p>
          </div>
        </div>
      </div>
    </div>
  </section>
{% endfor %}


<script type="text/javascript">

  function showMessage(notification) {
    $("#thanks h2").text(notification.title);
    $("#thanks .lead").text(notification.message);
    $("#thanks").fadeIn(500);

    setTimeout(function() {
      $('#thanks').fadeOut('slow');
    }, 3000);
  }

  function updateProfile(resp) {
    window.console.log(resp);
    $.scrollTo($("#"));
    if (resp.error) {
      var notification = { title: 'Error', message: resp.error };
      showMessage(notification);
    } else {
      // Set Message
      var notification = { title: '', message: "Loading profile information..." };
      showMessage(notification);
      // Set cookie for memberEmail
      $.cookie('memberEmail', resp.email_address, { expires: 7, path: '/' });
      // Populate form values with response
      $("#confirm_email").val(resp.email_address);
      $("#confirm_first_name").val(resp.merge_fields.FNAME);
      $("#confirm_last_name").val(resp.merge_fields.LNAME);
      $("#confirm_zip_code").val(resp.merge_fields.ZIP);
      $("#confirm_organization").val(resp.merge_fields.ORG);
      $("#confirm_stakeholders").val(resp.merge_fields.STAKEHOLDE);
      $("#confirm_solutions").val(resp.merge_fields.SOLUTIONS);
      
      $("#signup-signin").hide();
      $("#profile").fadeIn();
      $('.chapter').find('.message').fadeOut().end()
                    .find('.button').removeClass('disabled');
    }
  }
  $('#profile form').ajaxForm({
    dataType: 'json',
    beforeSubmit: function(arr, $form, options) { 
      // The array of form data takes the following form: 
      // [ { name: 'username', value: 'jresig' }, { name: 'password', value: 'secret' } ] 
      // return false to cancel submit
    },
    success: function(resp) {
      updateProfile(resp);
    },
    error: function() {
      window.console.log("OOPS");
      var notification = { title: 'Error', message: "Sorry we have experienced an unexpected issue. Please try again." };
      showMessage(notification);
    }
  });

  $('#signup_form').ajaxForm({
    dataType: 'json',
    beforeSubmit: function(arr, $form, options) { 
      // The array of form data takes the following form: 
      // [ { name: 'username', value: 'jresig' }, { name: 'password', value: 'secret' } ] 
      // return false to cancel submit
    },
    success: function(resp) {
      updateProfile(resp);
    },
    error: function() {
      window.console.log("OOPS");
      var notification = { title: 'Error', message: "Sorry we have experienced an unexpected issue. Please try again." };
      showMessage(notification);
    }
  });

  $('#signin_form').ajaxForm({
    dataType: 'json',
    beforeSubmit: function(arr, $form, options) { 
      // The array of form data takes the following form: 
      // [ { name: 'username', value: 'jresig' }, { name: 'password', value: 'secret' } ] 
      // return false to cancel submit
    },
    success: function(resp) {
      updateProfile(resp);
    },
    error: function() {
      window.console.log("OOPS");
      var notification = { title: 'Error', message: "Sorry we have experienced an unexpected issue. Please try again." };
      showMessage(notification);
    }
  });

  $(function() {
    if ($.cookie('memberEmail')) {
      $('#signup-signin').hide();
      $.ajax({
        url: "http://localhost:5000/signin",
        data: {email_return: $.cookie('memberEmail')},
        success: function(resp) {
          updateProfile(resp);
        }
      });
    }
  });

  $('.chapter .button').on('click', function(e) {
    if($(this).hasClass('disabled')) {
      e.stopPropagation();
      alert("Please fill in form details to enable download.");
      $.scrollTo('#signup-form');
    }
  });
</script>


