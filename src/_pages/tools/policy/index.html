---
layout: policy_tool
title: Policy Tool
permalink: /tools/policy/
slug: policy-tool

header: "U.S. Food Waste Policy Finder"
---
<div id="policynav">
  <div class="sticky">
    <h4 class="prevention">Prevention Policy</h4>
    <p>Policy changes related to date labelling have the potential to prevent 398,000 tons of waste per year</p>
    <ul>
      <li class="checkbox">
        <input id="date_labelling_filters" type="checkbox" value="">
        <label for="date_labelling_filters">
          <span></span>
          Date Labelling
          <small>Reveal state policies that hinder food waste prevention</small>
        </label>
      </li>
    </ul>
    <a href="/tools/policy/date-labels" class="button prevention">Explore date labeling<br>policy issues in depth &nbsp; &gt;</a>

    <h4 class="recovery">Recovery Policy</h4>
    <p>Federal policy provides liability protection and tax incentives for donating food. States have the opportunity to spur greater food recovery by enacting stronger policies in both areas.</p>
    {% assign section = site.data.policy_tool['liability_protection'] %}
    {% include tools/policy_tool_filter.html section=section %}

    {% assign section = site.data.policy_tool['tax_incentives'] %}
    {% include tools/policy_tool_filter.html section=section %}

    <h4 class="recycling">Recycling Policy</h4>
    <p>Increased food scrap recycling can be incentivized by these state and local policies.</p>
    {% assign section = site.data.policy_tool['animal_feed'] %}
    {% include tools/policy_tool_filter.html section=section %}
    
    {% assign section = site.data.policy_tool['organics_recycling_mandates'] %}
    {% include tools/policy_tool_filter.html section=section %}
  </div>
</div>
<section>
  <div class="container-fluid">
    <div class="row middle-xs center-xs">
      <div class="col-xs-12">
        <div id="federal-state-nav">
          <a href="/tools/policy/federal" class="button">Federal<br>Policy</a>
          <a href="#" class="button active">State<br>Policy</a>
        </div>
        <div id="map">
          <div id="map-instructions">
            <div class="content">
              <h4>U.S. Food Waste Policy Finder</h4>
              <p>Use this tool to research current food waste policy at the federal and state levels and to discover best practices and recommendations for policy improvements that will support more food waste prevention, recovery and recycling.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="row middle-xs center-xs">
      <div class="col-sm-3">
        <label for="state-select">Explore Food Waste Policy by State</label>
      </div>
      <div class="col-sm-9">
        <div class="select">
          <select name="" id="state-select">
            <option>Choose State</option>
            {% for state in site.states %}
              <option value="{{ state.url }}">{{ state.name }}</option>
            {% endfor %}
          </select>
        </div>
      </div>
    </div>
  </div>
</section>



<script>
  $('#state-select').change(function(){
    var value = $(this).val();
    window.console.log('value', value);
    var url = $(this).val(); // get selected value
      if (url) { // require a URL
          window.location = url; // redirect
      }
      return false;
  });

  $('input[type="checkbox"]').change(function(e) {

    var checked = $(this).prop("checked"),
        container = $(this).parent(),
        siblings = container.siblings();
    window.console.log("CONTAINER: ", container);

    container.find('input[type="checkbox"]').prop({
      indeterminate: false,
      checked: checked
    });

    function checkSiblings(el) {

      var parent = el.parent().parent(),
          all = true;

      el.siblings().each(function() {
        return all = ($(this).children('input[type="checkbox"]').prop("checked") === checked);
      });

      if (all && checked) {

        parent.children('input[type="checkbox"]').prop({
          indeterminate: false,
          checked: checked
        });

        checkSiblings(parent);

      } else if (all && !checked) {

        parent.children('input[type="checkbox"]').prop("checked", checked);
        parent.children('input[type="checkbox"]').prop("indeterminate", (parent.find('input[type="checkbox"]:checked').length > 0));
        checkSiblings(parent);

      } else {

        el.parents("li").children('input[type="checkbox"]').prop({
          indeterminate: true,
          checked: false
        });

      }

    }

    checkSiblings(container);
  });

</script>


<!-- Map -->
<script src="http://d3js.org/d3.v3.min.js"></script>
<script type="text/javascript">

  /*  This visualization was made possible by modifying code provided by:

  Scott Murray, Choropleth example from "Interactive Data Visualization for the Web" 
  https://github.com/alignedleft/d3-book/blob/master/chapter_12/05_choropleth.html   
      
  Malcolm Maclean, tooltips example tutorial
  http://www.d3noob.org/2013/01/adding-tooltips-to-d3js-graph.html

  Mike Bostock, Pie Chart Legend
  http://bl.ocks.org/mbostock/3888852  */

      
  //Width and height of map
  var width = 960;
  var height = 500;

  // D3 Projection
  var projection = d3.geo.albersUsa()
             .translate([width/2, height/2])    // translate to center of screen
             .scale([1000]);          // scale things down so see entire US
          
  // Define path generator
  var path = d3.geo.path()               // path generator that will convert GeoJSON to SVG paths
           .projection(projection);  // tell path generator to use albersUsa projection

  //Create SVG element and append map to the SVG
  var svg = d3.select("#map")
        .append("svg")
        .attr("preserveAspectRatio", "xMinYMin meet")
        .attr("viewBox", "0 0 960 500");
        // .attr("width", width)
        // .attr("height", height);

  // Append Div for tooltip to SVG
  var tip = d3.select("#map")
          .append("span")   
          .attr("class", "map-tooltip")               
          .style("opacity", 0);      

  // Load GeoJSON data and merge with states data
  d3.json("/data/us-states.json", function(json) {
    // Bind the data to the SVG and create one path per GeoJSON feature
    svg.selectAll("path")
    .data(json.features)
    .enter()
    .append("path")
    .attr("d", path)
    .style("stroke", "#fff")
    .style("stroke-width", "1")  
    .style("fill", "rgb(42,129,117)")
    .on("mouseover", function(d) {    
       //  tip.transition()        
       // .duration(200)      
       // .style("opacity", .9);      
       // tip.text(d.properties.name)
       // .style("left", (d3.event.pageX) + "px")     
       // .style("top", (d3.event.pageY - 10) + "px");
       window.console.log("hover", d);
       d3.select(this).style("opacity", .9); 
    }) 
    .on("mouseout", function(d) {       
      d3.select(this).style("opacity", 1);    
    });
  });
</script>